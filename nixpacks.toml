[build.staticAssets]
Caddyfile = """# global options
{
  admin off
  persist_config off
  auto_https off
  log {
    format json
  }
  servers {
    trusted_proxies static private_ranges 100.0.0.0/8
  }
}
# site block, listens on the $PORT environment variable (5000)
:{$PORT:5000} {
  log {
    format json
  }
  
  # Serve static files from dist folder
  root * ../app/dist
  encode gzip
  
  # Proxy /api requests to the Node server on port 3000
  reverse_proxy /api/* localhost:3000
  
  # Serve static assets directly (js, css, images, etc.)
  @static {
    path /assets/* *.js *.css *.png *.jpg *.jpeg *.gif *.svg *.ico *.woff *.woff2 *.ttf *.eot
  }
  handle @static {
    file_server
    header Cache-Control "public, max-age=31536000, immutable"
  }
  
  # SPA fallback - redirect to index.html for client-side routing
  handle {
    try_files {path} /index.html
    file_server
  }
}"""