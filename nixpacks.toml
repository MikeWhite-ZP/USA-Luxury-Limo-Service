[build.staticAssets]
Caddyfile = """# global options
{
  admin off
  persist_config off
  auto_https off
  log {
    format json
  }
  servers {
    trusted_proxies static private_ranges 100.0.0.0/8
  }
}

# site block, listens on the $PORT environment variable (5000)
:{$PORT:5000} {
  log {
    format json
  }

  # Proxy /api requests to the Node server on port 3000
  reverse_proxy /api/* localhost:3000

  # Serve static files from dist folder
  root * ../app/dist
  encode gzip
  file_server

  # SPA fallback - redirect to index.html for client-side routing
  try_files {path} /index.html
}"""